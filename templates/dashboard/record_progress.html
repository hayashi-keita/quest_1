{% extends "layout.html" %}

{% block content %}
  <h2 class="mb-4">ğŸ“ˆ è¨˜éŒ²æ¨ç§» - {{ user.name }} ã•ã‚“</h2>
  <!-- è¨˜éŒ²æ¨ç§»ã‚¿ã‚¤ãƒˆãƒ«ã®ã™ãä¸‹ã«è¿½åŠ  -->
<div class="mb-3">
  <a href="{{ url_for('dashboard.record_profile', user_id=user.id) }}" class="btn btn-outline-primary">
    ğŸ“Š ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’è¦‹ã‚‹
  </a>
</div>


  <canvas id="progressChart" height="120"></canvas>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- JSONãƒ‡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã¿ -->
  <script id="progress-data" type="application/json">
    {{ {
      "dates": dates,
      "run_50m": run_50m,
      "base_running": base_running,
      "long_throw": long_throw,
      "pitch_speed": pitch_speed,
      "swing_speed": swing_speed,
      "hit_speed": hit_speed,
      "bench_press": bench_press,
      "squat": squat
    } | tojson | safe }}
  </script>

  <!-- ãƒãƒ£ãƒ¼ãƒˆæç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const data = JSON.parse(document.getElementById('progress-data').textContent);

      const ctx = document.getElementById('progressChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.dates,
          datasets: [
            {
              label: '50mèµ°ï¼ˆç§’ï¼‰',
              data: data.run_50m,
              borderColor: 'rgba(255, 99, 132, 1)',
              backgroundColor: 'rgba(255, 99, 132, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'ãƒ™ãƒ¼ã‚¹ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ï¼ˆç§’ï¼‰',
              data: data.base_running,
              borderColor: 'rgba(75, 192, 192, 1)',
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'é æŠ•ï¼ˆmï¼‰',
              data: data.long_throw,
              borderColor: 'rgba(153, 102, 255, 1)',
              backgroundColor: 'rgba(153, 102, 255, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'çƒé€Ÿï¼ˆkm/hï¼‰',
              data: data.pitch_speed,
              borderColor: 'rgba(255, 159, 64, 1)',
              backgroundColor: 'rgba(255, 159, 64, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'ã‚¹ã‚¤ãƒ³ã‚°é€Ÿåº¦ï¼ˆkm/hï¼‰',
              data: data.swing_speed,
              borderColor: 'rgba(54, 162, 235, 1)',
              backgroundColor: 'rgba(54, 162, 235, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'æ‰“çƒé€Ÿåº¦ï¼ˆkm/hï¼‰',
              data: data.hit_speed,
              borderColor: 'rgba(255, 206, 86, 1)',
              backgroundColor: 'rgba(255, 206, 86, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹ï¼ˆkgï¼‰',
              data: data.bench_press,
              borderColor: 'rgba(201, 203, 207, 1)',
              backgroundColor: 'rgba(201, 203, 207, 0.2)',
              fill: false,
              tension: 0.1
            },
            {
              label: 'ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆï¼ˆkgï¼‰',
              data: data.squat,
              borderColor: 'rgba(0, 128, 0, 1)',
              backgroundColor: 'rgba(0, 128, 0, 0.2)',
              fill: false,
              tension: 0.1
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'å„é …ç›®ã®è¨˜éŒ²æ¨ç§»ï¼ˆæ‰¿èªæ¸ˆã®ã¿ï¼‰'
            },
            legend: {
              position: 'top'
            },
            tooltip: {
              mode: 'index',
              intersect: false
            }
          },
          interaction: {
            mode: 'nearest',
            axis: 'x',
            intersect: false
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'æ¸¬å®šå€¤'
              }
            },
            x: {
              title: {
                display: true,
                text: 'æœˆï¼ˆYYYY-MMï¼‰'
              }
            }
          }
        }
      });
    });
  </script>
{% endblock %}
